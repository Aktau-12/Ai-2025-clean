import sys
import os

# Добавляем корень проекта в sys.path, чтобы избежать ошибки ModuleNotFoundError
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "../..")))

from sqlalchemy.orm import Session
from app.database.db import SessionLocal
from app.models.strengths import Strength  # Импортируем модель Strength

# 34 качества Гэллапа
GALLUP_STRENGTHS = [
    ("Аналитик", "Вы любите искать причины и закономерности."),
    ("Активатор", "Вы быстро переходите от идеи к действию."),
    ("Адаптивность", "Вы легко приспосабливаетесь к изменениям."),
    ("Влияние", "Вы умеете убеждать и вдохновлять людей."),
    ("Гармония", "Вы стремитесь к согласию и миру."),
    ("Дисциплина", "Вы любите порядок и структуру."),
    ("Достижение", "Вы ориентированы на результат."),
    ("Идеатор", "Вы видите мир через призму идей."),
    ("Индивидуализация", "Вы замечаете уникальные качества людей."),
    ("Контекст", "Вы анализируете прошлое для понимания будущего."),
    ("Командный игрок", "Вы отлично работаете в группе."),
    ("Коммуникация", "Вы умеете ясно и интересно выражать мысли."),
    ("Конкурентность", "Вы стремитесь быть первым."),
    ("Максимайзер", "Вы развиваете сильные стороны в себе и других."),
    ("Мыслитель", "Вы любите размышлять о сложных вопросах."),
    ("Надежность", "Вы всегда выполняете свои обещания."),
    ("Обучаемость", "Вы жаждете знаний и развития."),
    ("Организатор", "Вы умеете координировать людей и ресурсы."),
    ("Оратор", "Вы умеете находить нужные слова."),
    ("Ответственность", "Вы берете на себя обязательства и выполняете их."),
    ("Перспектива", "Вы видите будущее и вдохновляете."),
    ("Позитив", "Вы наполняете мир энергией и оптимизмом."),
    ("Развитие", "Вы помогаете другим расти."),
    ("Расстановка приоритетов", "Вы выбираете, что действительно важно."),
    ("Связь", "Вы видите мир как единое целое."),
    ("Справедливость", "Вы верите в честность и равенство."),
    ("Стратег", "Вы находите наилучшие пути решения."),
    ("Фокус", "Вы концентрируетесь на главном."),
    ("Харизматичность", "Вы умеете заряжать людей."),
    ("Чувствительность", "Вы понимаете эмоции других."),
    ("Эмпатия", "Вы чувствуете, что переживают другие."),
    ("Энтузиазм", "Вы заряжены энергией и передаете её другим."),
    ("Ясность", "Вы ясно видите ситуации и принимаете решения."),
    ("Восстановление", "Вы умеете замечать, что сломано, и чинить это.")  # Возможно, его не хватало
]

def add_missing_strengths(db: Session):
    """Добавляет недостающие качества"""
    existing_names = {s.name for s in db.query(Strength).all()}
    added_count = 0

    for name, description in GALLUP_STRENGTHS:
        if name not in existing_names:
            db.add(Strength(name=name, description=description))
            print(f"➕ Добавлено: {name}")
            added_count += 1

    if added_count > 0:
        db.commit()
        print(f"✅ Добавлено новых качеств: {added_count}")
    else:
        print("✅ Все 34 качества уже есть в базе.")

if __name__ == "__main__":
    db = SessionLocal()
    add_missing_strengths(db)
    db.close()
